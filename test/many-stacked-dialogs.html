<!DOCTYPE html>
<html lang="en">  
  <head>
    <title>Modalator :: Many Stacked Dialogs</title>
    <meta charset="utf-8"/>
    <script src="../assets/jquery-2.1.1.min.js"></script>
    <script src="../assets/bootstrap-3.3.1/js/bootstrap.min.js"></script>
    <script src="../assets/bootstrap-modal-2.2.5/js/bootstrap-modalmanager.js"></script>
    <script src="../assets/bootstrap-modal-2.2.5/js/bootstrap-modal.js"></script>
    <script src="../src/modalator-0.1/modalator.js"></script>
    <link rel="stylesheet" href="../assets/bootstrap-3.3.1/css/bootstrap.css"/>
    <link rel="stylesheet" href="../assets/bootstrap-modal-2.2.5/css/bootstrap-modal-bs3patch.css"/>
    <link rel="stylesheet" href="../assets/bootstrap-modal-2.2.5/css/bootstrap-modal.css"/>
  </head>
  <body style="margin:20px">
    <script>
      var SIZE = 5;
      var WIDTH = SIZE * 100;
      var PREFIX = 'dialog';

      var launcher = Modalator.launcher.button({
          text: 'Launch Modal Dialog',
          attrs: {href: '#' + PREFIX + '0'}
      });

      var callbackConstructor = function(idx) {
          if (idx + 1 < SIZE) {
              return function() {
                  var nextIdx = parseInt(idx) + 1;
                  console.log('FORWARD TO ' + nextIdx);
                  $('#' + PREFIX + nextIdx).modal('show');
              }
          }
          return function() {
              for (var n = 0; n <= SIZE; n++) {
                  $('#' + PREFIX + n).modal('hide');
              }
              console.log('SUCCESS');
          }
      }

      var dialogs = [];
      for (var num = 0; num < SIZE; num++) {
          var id = PREFIX + num;
          var width = WIDTH - (60 * num);

          dialogs[num] = Modalator.dialog({ 
              title: {text: 'Input Dialog ' + num},
              attrs: {id: id, 'data-width': width},
              body: {
                  text: "Dialog number " + num
                      + ". Don't give up..."
              },
              affirm: {
                  text: num + 1 < SIZE ? 'Forward' : 'Finish',
                  attrs: {
                      onclick: callbackConstructor(num)
                  }
              },
              cancel: {text: !num ? 'Cancel' : 'Back'}
          });
      }

      document.addEventListener('DOMContentLoaded', function() { 
          Modalator.appendToDOM([launcher].concat(dialogs));
      });
    </script>
  </body>
</html>
